"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6006],{76006:function(e,t,s){s.r(t),s.d(t,{MfaVerifyFlowScreen:function(){return i},default:function(){return i}});var l=s(57437),n=s(2265),r=s(89660),o=s(75599),a=s(27296),u=s(87796);s(29155),s(87336),s(97048),s(64131),s(84250);let i=({onClose:e})=>{let{user:t}=(0,o.u)(),s=(0,r.u)(),i=(0,n.useMemo)(()=>t?.mfaMethods.filter(e=>"passkey"!==e||!s.globalDisablePasskeys)??[],[t?.mfaMethods,s.globalDisablePasskeys]),[c,f]=(0,n.useState)(i[0]??null),{init:d,cancel:h,submit:k}=(0,a.u)(),[y,b]=(0,n.useState)(!1),[w,m]=(0,n.useState)(null),[S,g]=(0,n.useState)();(0,n.useEffect)(()=>{f(i[0]??null)},[i]);let v=(0,n.useRef)(!1);async function p(t){g(void 0);try{if(!t||!c)return;await k(c,t),b(!0),g(void 0),e()}catch(e){throw(0,u.t)(e).error}}async function C(t){if("passkey"!==t)try{f(t),await d(t)}catch(e){console.error(e)}else try{f(t);let s=await d(t);if(!s)throw Error("something went wrong");m(s),await k(t,s),b(!0),g(void 0),e()}catch(e){g((0,u.t)(e))}}(0,n.useEffect)(()=>{!v.current&&c&&(v.current=!0,C(c).finally(()=>{v.current=!1}))},[]);let E=()=>{f(null),g(void 0),h(),e()};return t?"passkey"===c?(0,l.jsx)(u.V,{account:t.linkedAccounts.filter(e=>"passkey"===e.type&&e.enrolledInMfa).sort((e,t)=>t.firstVerifiedAt.valueOf()-e.firstVerifiedAt.valueOf())[0],submitSuccess:y,hasBlockingError:S?.isBlocking??!1,error:S?.error,onClose:E,onBack:()=>{f(null),g(void 0)},handleSubmit:()=>p(w).catch(g)}):c?(0,l.jsx)(u.a,{submitSuccess:y,hasBlockingError:S?.isBlocking??!1,handleSubmitCode:p,selectedMethod:c,onClose:E,onBack:i.length>1?()=>f(null):void 0}):(0,l.jsx)(u.b,{mfaMethods:i,onSelect:C,handleClose:E}):null}}}]);