"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1659],{61659:function(e,t,a){a.r(t),a.d(t,{EmbeddedWalletPasswordCreateScreen:function(){return i},default:function(){return i}});var s=a(57437),r=a(2265),n=a(89660),l=a(27296),o=a(71554),u=a(75599),c=a(24791);a(29155),a(87336),a(97048),a(64131),a(84250),a(39417),a(4657);let i={component:()=>{let{navigate:e,data:t,onUserCloseViaDialogOrKeybindRef:a}=(0,u.a)(),i=(0,n.u)(),[d,h]=(0,r.useState)(""),[w,f]=(0,r.useState)(!1),[y,S]=(0,r.useState)(),[p,m]=(0,r.useState)(null),{create:v}=(0,l.v)(),{authenticated:C,user:g}=(0,u.u)(),{closePrivyModal:b,isNewUserThisSession:P,initializeWalletProxy:E}=(0,o.u)(),{onSuccess:U,onFailure:x,callAuthOnSuccessOnClose:O,shouldCreateEth:A,shouldCreateSol:T}=t.createWallet,[I,M]=(0,r.useState)(null),k=new l.R(async()=>{try{let t;if(A&&T)t=await v({recoveryMethod:"user-passcode",recoveryPassword:y,chainType:"ethereum",walletIndex:0,latestUser:g}),t=await v({chainType:"solana",walletIndex:0,latestUser:t.user});else if(T)t=await v({recoveryMethod:"user-passcode",recoveryPassword:y,chainType:"solana",walletIndex:0,latestUser:g});else{if(!A)throw Error("Invalid args to create wallet");t=await v({recoveryMethod:"user-passcode",recoveryPassword:y,chainType:"ethereum",walletIndex:0,latestUser:g})}M(t),P?e("EmbeddedWalletCreatedScreen"):(U(t),b({shouldCallAuthOnSuccess:O}))}catch(e){h(e.message)}});return(0,r.useEffect)(()=>{p||E(3e4).then(e=>m(e))},[p]),(0,r.useEffect)(()=>{if(!C||!g)return e("LandingScreen"),void x(Error("User must be authenticated before creating a Privy wallet"))},[C]),a.current=()=>null,(0,s.jsx)(c.S,{config:{initiatedBy:"automatic"},appName:i?.name||"privy",loading:!p,buttonLoading:w,buttonHideAnimations:!I&&w,isResettingPassword:!1,error:d,password:y||"",onClose:()=>{I&&"user-passcode"!==I.account.recoveryMethod?(x(new o.m("User created a wallet but failed to set a password for it")),b({shouldCallAuthOnSuccess:!1})):I?(U(I),b({shouldCallAuthOnSuccess:O})):(x(new o.m("User wallet creation failed")),b({shouldCallAuthOnSuccess:!1}))},onPasswordChange:S,onPasswordGenerate:()=>S((0,c.g)()),onSubmit:async()=>(f(!0),k.execute().then(()=>new Promise(e=>setTimeout(e,250))).finally(()=>f(!1)))})}}}}]);